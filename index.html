<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>smart-component</title>

  <link rel="apple-touch-icon" sizes="180x180" href="./resources/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./resources/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./resources/favicon-16x16.png">
  <link rel="manifest" href="./resources/site.webmanifest">

  <link href="https://fonts.googleapis.com/css?family=Maven+Pro:400,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/themes/prism-okaidia.min.css">

  <link rel="stylesheet" href="./style.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>
</head>
<body>
  <div class="s-header">
    <svg class="s-header__logo" viewBox="0 0 514 514" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M246.15 208.03a8.63 8.63 0 0 0-7.38-2.27l-52.38 8.76a8.57 8.57 0 0 0-4.81 2.55L27.7 378.25a8.63 8.63 0 0 0 .29 12.2l46.06 43.96a8.6 8.6 0 0 0 12.19-.28l153.87-161.18 6.04-64.92zm0 0a8.58 8.58 0 0 1 2.6 7.26m-2.6-7.26l2.6 7.26m0 0l-6.31 52.73m6.3-52.73l-6.3 52.73m0 0a8.65 8.65 0 0 1-2.33 4.93l2.33-4.93z" fill="#CCD1D9" stroke="#434A54" stroke-width="4"/><path d="M182.43 268.22a8.63 8.63 0 1 1-8.82-8.43 8.62 8.62 0 0 1 8.82 8.43zM174.71 307.07a8.63 8.63 0 1 1-.4-17.25 8.63 8.63 0 0 1 .4 17.25zM153.09 298.95a8.62 8.62 0 1 1-17.24.39 8.62 8.62 0 1 1 17.24-.39zm-19.24.44zM153.79 329a8.62 8.62 0 1 1-8.83-8.43 8.64 8.64 0 0 1 8.83 8.42zM123.74 329.7a8.62 8.62 0 1 1-17.24.4 8.63 8.63 0 1 1 17.24-.4zm-19.24.45zM124.44 359.73a8.62 8.62 0 1 1-8.82-8.41 8.61 8.61 0 0 1 8.82 8.41z" fill="#AAB2BC" stroke="#434A54" stroke-width="4"/><path d="M383.34 97.9c24.8 48.28 53.43 123.74 105.72 278.7.8 2.41.5 5.05-.81 7.23a8.56 8.56 0 0 1-6.04 4.06l-130.7 20.43h-.02a8.65 8.65 0 0 1-9.77-6.67l-15.25-69.25a8.64 8.64 0 0 1 5.05-9.8l15.05-6.38 1.8-.76-.72-1.81c-11.03-28.09-43.85-111.19-65.16-160.08-12.38-28.4-14.7-60.8-6.58-93.73 5.99-24.42 15.61-40.68 16.2-41.66v-.01a8.62 8.62 0 0 1 10.36-3.64c14.53 5.35 27.63 12.4 40.63 24.95 13.03 12.57 26.04 30.73 40.24 58.42z" fill="#E6E9ED" stroke="#434A54" stroke-width="4"/><path d="M76.39 353.98H437.6c39.92 0 72.4 32.48 72.4 72.38s-32.47 72.38-72.4 72.38H76.4C36.47 498.74 4 466.27 4 426.36c0-39.9 32.47-72.38 72.39-72.38z" fill="#ED5564" stroke="#434A54" stroke-width="4"/><path opacity=".1" d="M437.6 490.11H76.4c-39.24 0-71.46-30.52-74.2-69.07-.13 1.76-.19 3.53-.19 5.32 0 41.01 33.37 74.38 74.39 74.38H437.6c41.03 0 74.4-33.37 74.4-74.38 0-1.79-.06-3.56-.19-5.32-2.74 38.55-34.95 69.07-74.2 69.07z" fill="#080808"/><path d="M437.7 435.07h-42.66a8.62 8.62 0 1 1 0-17.25h42.66a8.62 8.62 0 1 1 0 17.25z" fill="#CCD1D9" stroke="#434A54" stroke-width="4"/><path d="M416.37 456.4a8.62 8.62 0 0 1-8.63-8.62v-42.66a8.62 8.62 0 1 1 17.25 0v42.66a8.63 8.63 0 0 1-8.62 8.63z" fill="#E6E9ED" stroke="#434A54" stroke-width="4"/><path d="M93.1 420.26a8.64 8.64 0 0 1-12.2 12.2 8.64 8.64 0 0 1 12.2-12.2z" fill="#434A54" stroke="#434A54" stroke-width="4"/><path d="M410.29 235.64l-28.75-74.75v-.01a8.62 8.62 0 1 1 16.1-6.18l28.74 74.75a8.62 8.62 0 1 1-16.1 6.2z" fill="#CCD1D9" stroke="#434A54" stroke-width="4"/></svg>
    <div class="s-header__text">smart-component</div>
  </div>

  <div class="s-container">
    <div class="s-content">
      <h2>What is smart-component?</h2>

      <p>Smart-component is a simple extension of the base HTMLElement class. It helps developers to easily create feature rich web components.</p>

      <p>Features:</p>

      <ul>
        <li>Unified attribute and property handling</li>
        <li>State value transforming</li>
        <li>Auto-bind property to state</li>
        <li>Communication between parent and child components</li>
        <li>Lighterhtml based templating</li>
        <li>Local and global state management</li>
        <li>Extra callbacks to never miss a moment</li>
        <li>And much more...</li>
      </ul>
    </div>
  </div>

  <div class="s-docs">
    <h2 class="s-docs__title">Documentation</h2>

    <h3 class="s-docs__title">Attributes, properties and basic templating</h3>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Add <b>observedAttributes</b> getter to the component to listen on a list of attributes or properties.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get observedAttributes() {
            return ['value'];
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Every component has built in state management and you can easily make a connection between properties and state by defining <b>boundProperties</b> getter.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get boundProperties() {
            return ['value'];
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Templating has never been easier than it is now with smart-component. Just define a <b>template</b> getter on the component, and pass a container to the component options to enable rendering.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get template() {
            return component => html`The value is: &lt;b&gt;${component._state.get('value')}&lt;/b&gt;`;
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">By default the container is appended to the component. It can be changed to <b>prepend</b> instead.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          super.init({
            'render.prepend': true
          });
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">The component can add classes to itself with the <b>className</b> option. The parameter is a string and multiple classes can be append with a space between classes.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          super.init({
            className: 'my-example-1 my-example-1--dark'
          });
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <div class="s-example">
          <h3>Test the final component</h3>

          <div>
            <my-example-1 value="0"></my-example-1>
          </div>
          <button id="example-1-button-property">Set random value on component</button>

          <script>
            document.querySelector('#example-1-button-property').addEventListener('click', () => {
              document.querySelector('my-example-1').value = Math.random();
            });
          </script>
        </div>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          class MyExample1 extends SmartComponent {
            static get observedAttributes() {
              return ['value'];
            }

            static get boundProperties() {
              return ['value'];
            }

            static get template() {
              return (html, component) => html`The value is: &lt;b&gt;${component._state.get('value')}&lt;/b&gt;`;
            }
          }
        </code></pre>
      </div>
    </div>

  </div>

  <div class="s-docs">
    <h3 class="s-docs__title">Communication between parent and child</h3>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">First of all, in the parent component's constructor you have to set <b>listenChildren</b> option to <i>true</i>. It will prepares the parent to be able to receive events from children.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          super.init({
            listenChildren: true
          });
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">You have to do almost the same thing with the child component, except the option called <b>notifyParent</b>. This will make the component send events on <i>connect, disconnect and state changes</i>.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          super.init({
            notifyParent: true
          });
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">In the parent component, a new callback can be used for handling the events, <b>childrenChangedCallback</b>. This callback gives back the whole list of connected children. What you doing with this data is up to you. In this example we will use it to store the child's value from it's state.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          childrenChangedCallback(collection) {
            const childrenList = collection.get();

            const items = childrenList.map(child => {
              this._state.set('childValue', child.state.value);
            });
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">A parent can have multiple different kind of children, and because of that the <b>collection</b> can give back them separately, if you want. Only thing you have to do is defining a <b>first parameter</b> with a tag name.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          const childrenList = collection.get('my-example-2-child');
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <div class="s-example">
          <h3>Test the final component</h3>

          <div>
            <my-example-2>
              <my-example-2-child value="0"></my-example-2-child>
            </my-example-2>
          </div>
          <button id="example-2-button-property">Set random value on child</button>

          <script>
            document.querySelector('#example-2-button-property').addEventListener('click', () => {
              document.querySelector('my-example-2-child').value = Math.random();
            });
          </script>
        </div>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          // Parent definition
          class MyExample2 extends SmartComponent {
            init() {
              this._container = this._parseHTML(`&lt;div class="my-example-2-value"&gt;&lt;/div&gt;`);

              super.init({
                listenChildren: true,
                render: {
                  container: this._container
                }
              });
            }

            static get template() {
              return (html, component) => html`Value of the child component is: &lt;b&gt;${component._state.get('childValue')}&lt;/b&gt;`;
            }

            childrenChangedCallback(collection) {
              const childrenList = collection.get();

              const items = childrenList.map(child => {
                this._state.set('childValue', child.state.value);
              });
            }
          }

          /*------------------------------------------------------------------*/

          // Child definition
          class MyExample2Child extends SmartComponent {
            init() {
              super.init({
                notifyParent: true
              });
            }

            static get observedAttributes() {
              return ['value'];
            }

            static get boundProperties() {
              return ['value'];
            }
          }

        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">If you don't want to notify the parent on every state change you can define it in the <b>boundProperties</b>. It's useful when the parent sets this value on the component, so it won't report back the change.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get boundProperties() {
            return [
              {
                name: 'value',
                options: {
                  triggerCallback: false
                }
              }
            ];
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Another interesting option in the <b>boundProperties</b> is that you can tell the component to store the value with a different name in state.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get boundProperties() {
            return [
              {
                name: 'value',
                as: 'stateValue'
              }
            ];
          }
        </code></pre>
      </div>
    </div>

  </div>

  <div class="s-docs">
    <h3 class="s-docs__title">Event handling</h3>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Event handling is always something, what causing problems and makes our code much complex. With smart-component, this problem becomes much less painful. You can define an <b>eventHandlers</b> getter.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get eventHandlers() {
            return {
              ':click': '_onClick'
            }
          }

          _onClick(event) {
            // Do something here...
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <div class="s-example">
          <h3>Test the final component</h3>

          <div>
            <my-example-3></my-example-3>
          </div>
        </div>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          import SmartComponent from '../../libs/smartcomponent';

          export default class MyExample3 extends SmartComponent {
            static get defaultState() {
              return { clicks: 0 };
            }

            static get eventHandlers() {
              return { ':click': '_onClick' }
            }

            static get template() {
              return component => html`<button>Clicked <b>${component._state.get('clicks')}</b> times.</button>`
            }

            _onClick() {
              this._state.set('clicks', value => ++value);
            }
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Event handlers can be created through templates too using <b>data-handler</b> attribute and the event binding to the context.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get eventHandlers() {
            return {
              'button:click': '_onButtonClick'
            }
          }

          static get template() {
            return component => html`&lt;button data-handler="button" onclick="${component}" &gt;Click Me!&lt;/button&gt;`;
          }

          _onButtonClick(event) {
            // Do something here...
          }
        </code></pre>
      </div>
    </div>

  </div>

  <div class="s-docs">
    <h3 class="s-docs__title">State mangement</h3>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Every component has it's own <b>state</b>.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          this._state.set('value', 1);         // Sets value on local state
          this._state.get('value');            // Gets value from local state
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">You can pass <b>options to the state</b> on set.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          this._state.set('value', 1, {
            triggerCallback: false,     // Won't call the attached callbacks
            triggerRender: false        // Won't call render function
          });
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">A function can be also passed as value. Perfect for incrementing/decrementing values.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          this._state.set('value', value => value + 2);
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">With the awesome <b>subscription</b> system, you will always know, what's happening.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          this._state.subscribe('value', console.log);
          this._state.set('value', 1); // Logs '1, "value"'

          // Defining multiple at once with an array
          this._state.subscribe(['firstName', 'lastName'], console.log);
          this._state.set('firstName', 1); // Logs '1, "value"'
          this._state.set('lastName', 2); // Logs '2, lastName"'
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">Every subscription comes with an <b>unsubscribe</b> method.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          const subscription = this._state.subscribe('value', console.log);
          this._state.set('value', 1); // Logs '1, "value"'
          subscription.unsubscribe();
          this._state.set('value', 1); // Logs nothing
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">It has the ability to <b>nest values</b>.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          this._state.set('group.value', 1);

          this._state.get('group.value');   // Gets 1
          this._state.get('group');         // Gets { value: 1 }
          this._state.get();                // Ultimately gets { group: { value: 1 } }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">State values can be formatted. Basically, there is two ways of defining it. You can use the <b>stateOptions</b> getter or calling the <b>setOptions()</b> function on state.<br>Transforming has some predefined options, these are <i>number, integer, float, boolean, json</i>. When using one of these, <b>transformFunction</b> won't be called.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get stateOptions() {
            return {
              value: {
                type: 'custom',
                transformFunction: value => Number(value).toFixed(1)
              }
            }
          }

          /* OR */

          this._state.setOptions('value', {
            type: 'custom',
            transformFunction: value => Number(value).toFixed(1)
          });
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">If you defined a default value for the state variable, you can access it with calling <b>getDefaultValue()</b> function.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          this._state.setOptions('value', {
            defaultValue: 1
          });

          ...

          this._state.getDefaultValue('value'); // Gets 1
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text">State options can be defined through a static method too, called <b>stateOptions</b>.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          static get stateOptions() {
            return {
              value: {
                defaultValue: 'Default Value'
              }
            };
          }
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text"><b>Global state</b> is available in every instance and work exactly like the default component state.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
          this._globalState.set('value', 1);  // Sets 1
          this._globalState.get('value');     // Gets 1
        </code></pre>
      </div>
    </div>

    <div class="s-docs__block">
      <div class="s-docs__left">
        <p class="s-docs__text"><b>Prefixed global state</b> is useful, if you want to render only when a subset of state changed.</p>
      </div>
      <div class="s-docs__right">
        <pre><code class="language-javascript">
            init() {
              super.init({
                globalState: 'subset' // or an array ['subset1, subset2']
              });
            }

            ...

            this._globalState.set('subset.value');  // Triggers rendering in all component uses this prefix
        </code></pre>
      </div>
    </div>

  </div>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=Symbol%2CArray.prototype.find"></script>
  <script src="./bundle.js"></script>
</body>
</html>
